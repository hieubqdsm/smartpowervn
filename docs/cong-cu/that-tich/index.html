<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Máy Tính Chè Đậu Đỏ "Vị Mặn" - Mùa Thất Tịch</title>
    <!-- SEO & Basic Meta Tags -->
    <meta name="description"
        content="Công cụ 'khoa học' giúp bạn tính toán lượng nghiệp tình trường và số tấn chè đậu đỏ cần ăn để thoát ế mùa Thất Tịch. Thử ngay!">
    <meta name="keywords" content="thất tịch, chè đậu đỏ, thoát ế, tính duyên, máy tính tình yêu, troll">
    <meta name="author" content="Vũ Trụ Đậu Đỏ">

    <!-- Open Graph Meta Tags (for Facebook, Zalo, etc.) -->
    <meta property="og:title" content="Máy Tính Chè Đậu Đỏ Vị Mặn">
    <meta property="og:description"
        content="Nghiệp tình trường của bạn nặng bao nhiêu tấn? Cần ăn bao nhiêu chè đậu đỏ để thoát ế? Tính ngay!">
    <meta property="og:image"
        content="https://www.smartpowervn.com/cong-cu/that-tich/che_dau_do_vi_man.jpg">
    <meta property="og:url" content="https://www.smartpowervn.com/cong-cu/that-tich/"> <!-- Thay URL của bạn vào đây -->
    <meta property="og:type" content="website">

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Máy Tính Chè Đậu Đỏ Vị Mặn">
    <meta name="twitter:description"
        content="Nghiệp tình trường của bạn nặng bao nhiêu tấn? Cần ăn bao nhiêu chè đậu đỏ để thoát ế? Tính ngay!">
    <meta name="twitter:image"
        content="https://www.smartpowervn.com/cong-cu/that-tich/che_dau_do_vi_man.jpg">

    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@400;500;700&display=swap"
        rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-image: url('https://www.transparenttextures.com/patterns/az-subtle.png');
        }

        .font-pacifico {
            font-family: 'Pacifico', cursive;
        }

        /* Custom styles for range slider */
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #EF4444;
            /* red-500 */
            cursor: pointer;
            border-radius: 50%;
            margin-top: -6px;
        }

        input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #EF4444;
            /* red-500 */
            cursor: pointer;
            border-radius: 50%;
        }
    </style>
</head>

<body class="bg-rose-50 flex items-center justify-center min-h-screen p-4">

    <div
        class="w-full max-w-2xl bg-white rounded-2xl shadow-2xl p-8 space-y-6 transform transition-all hover:shadow-red-200">

        <!-- Header -->
        <div class="text-center">
            <h1 class="font-pacifico text-4xl text-red-600">Chè Đậu Đỏ Vị Mặn</h1>
            <p class="text-gray-500 mt-2">Công cụ "khoa học" giúp bạn thanh tẩy nghiệp tình trường mùa Thất Tịch!</p>
        </div>

        <!-- Form Calculation -->
        <div id="calculator-form" class="space-y-6">

            <!-- Section 1: Tình Trạng Cơ Bản -->
            <fieldset class="border-t border-gray-200 pt-4">
                <legend class="text-lg font-bold text-red-800 px-2">I. Hồ Sơ Tình Ái</legend>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                    <div>
                        <label for="soNamE" class="block text-sm font-medium text-gray-700">Số năm bạn "lẻ bóng"?
                            (S)</label>
                        <input type="number" id="soNamE" value="2" min="0" max="124"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500">
                        <p class="text-xs text-gray-400 mt-1">(0: đang có bồ, 124: từ lúc đẻ)</p>
                    </div>
                    <div>
                        <label for="soLanChiaTay" class="block text-sm font-medium text-gray-700">Số lần chia tay
                            (CT)</label>
                        <input type="number" id="soLanChiaTay" value="1" min="0"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500">
                    </div>
                    <div>
                        <label for="soLanKhongDo" class="block text-sm font-medium text-gray-700">Số lần bị dỗi nhưng ko
                            biết lý do (KD)</label>
                        <input type="number" id="soLanKhongDo" value="1" min="0"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-red-500 focus:ring-red-500">
                    </div>
                </div>
            </fieldset>

            <!-- Section 2: Chỉ Số Nội Tâm -->
            <fieldset class="border-t border-gray-200 pt-4">
                <legend class="text-lg font-bold text-red-800 px-2">II. Phân Tích Nội Tâm</legend>
                <div class="space-y-4 mt-4">
                    <div>
                        <label for="khatKhao" class="block text-sm font-medium text-gray-700">Độ khát khao có bồ (K):
                            <span id="khatKhaoValue" class="font-bold text-red-600">7</span>/10</label>
                        <input type="range" id="khatKhao" min="1" max="10" value="7"
                            class="w-full h-2 bg-red-100 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div>
                        <label for="hanhDong" class="block text-sm font-medium text-gray-700">Hệ số hành động so với
                            khao khát (H): <span id="hanhDongValue" class="font-bold text-red-600">4</span>/10</label>
                        <input type="range" id="hanhDong" min="1" max="10" value="4"
                            class="w-full h-2 bg-red-100 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div>
                        <label for="aoTuong" class="block text-sm font-medium text-gray-700">Hệ số ảo tưởng (AT): <span
                                id="aoTuongValue" class="font-bold text-red-600">6</span>/10</label>
                        <input type="range" id="aoTuong" min="1" max="10" value="6"
                            class="w-full h-2 bg-red-100 rounded-lg appearance-none cursor-pointer">
                    </div>
                    <div>
                        <label for="tinhNgo" class="block text-sm font-medium text-gray-700">Hệ số giác ngộ về tình yêu
                            (TN): <span id="tinhNgoValue" class="font-bold text-red-600">0.4</span>/1.0</label>
                        <input type="range" id="tinhNgo" min="0.1" max="1.0" step="0.1" value="0.4"
                            class="w-full h-2 bg-red-100 rounded-lg appearance-none cursor-pointer">
                    </div>
                </div>
            </fieldset>

            <!-- Button -->
            <button id="calculateBtn"
                class="w-full bg-red-500 text-white font-bold py-3 px-4 rounded-lg hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-transform transform hover:scale-105">
                Xem Quẻ Duyên Nợ
            </button>
        </div>

        <!-- Result Section -->
        <div id="result-section" class="text-center p-6 bg-rose-100 rounded-lg mt-6" style="display: none;">
            <h2 class="text-2xl font-bold text-red-800">Lượng Chè Cần "Nạp"</h2>
            <p class="text-gray-600 mb-4">Để cân bằng lại "nhân phẩm tình duyên", bạn cần tiêu thụ:</p>

            <div class="grid grid-cols-2 gap-4 text-center">
                <div class="p-4 bg-white rounded-lg shadow overflow-hidden">
                    <p class="text-xs text-gray-500">Định lượng</p>
                    <p id="result-dinhluong" class="text-xl sm:text-2xl font-bold text-red-600 break-words">0</p>
                </div>
                <div class="p-4 bg-white rounded-lg shadow overflow-hidden">
                    <p class="text-xs text-gray-500">Khối lượng</p>
                    <p id="result-khoiluong" class="text-xl sm:text-2xl font-bold text-red-600 break-words">0</p>
                </div>
            </div>

            <div class="mt-6 p-4 bg-red-50 border-l-4 border-red-500 text-left">
                <h3 class="font-bold text-red-700">Lời Khuyên "Chân Ái":</h3>
                <p id="result-advice" class="text-gray-700 mt-1"></p>
            </div>
        </div>
        <!-- Footer -->
        <div class="text-center text-xs text-gray-400 mt-6">
            <p>Sản phẩm mang tính giải trí cao. Tác dụng phụ không lường trước được.</p>
            <p>Ad ko bán chè đậu đỏ, đừng liên hệ mất công</p>
            <p style="color: blue;">Ad bán vật liệu và giải pháp thi công điện mặt trời, tự vào <a href="/index.html"
                    style="color: red;">trang chủ</a> để xem</p>
            <p>&copy; 2025 Vũ Trụ Đậu Đỏ. Mọi nghiệp quả xin tự chịu trách nhiệm.</p>
        </div>
    </div>

    <script>
        // Function to update slider value display
        function updateSliderValue(sliderId, displayId) {
            const slider = document.getElementById(sliderId);
            const display = document.getElementById(displayId);
            slider.addEventListener('input', () => {
                display.textContent = slider.value;
            });
        }

        updateSliderValue('khatKhao', 'khatKhaoValue');
        updateSliderValue('aoTuong', 'aoTuongValue');
        updateSliderValue('hanhDong', 'hanhDongValue');
        updateSliderValue('tinhNgo', 'tinhNgoValue');

        // Function to format large numbers into text with Vietnamese units
        function formatNumberToText(num) {
            if (num === Infinity) return 'Vô Cực';
            if (num < 1000) return num.toLocaleString('vi-VN', { maximumFractionDigits: 1 });
            if (num < 1e6) return (num / 1e3).toLocaleString('vi-VN', { maximumFractionDigits: 2 }) + ' nghìn';
            if (num < 1e9) return (num / 1e6).toLocaleString('vi-VN', { maximumFractionDigits: 2 }) + ' triệu';
            if (num < 1e12) return (num / 1e9).toLocaleString('vi-VN', { maximumFractionDigits: 2 }) + ' tỷ';
            return (num / 1e12).toLocaleString('vi-VN', { maximumFractionDigits: 2 }) + ' nghìn tỷ';
        }

        // Function to format mass with kg/ton units
        function formatMass(kg) {
            if (kg === Infinity) return 'Vô Cực';
            if (kg >= 1000) {
                const tan = kg / 1000;
                return formatNumberToText(tan) + ' tấn';
            }
            return formatNumberToText(kg) + ' kg';
        }

        const calculateBtn = document.getElementById('calculateBtn');
        const resultSection = document.getElementById('result-section');

        calculateBtn.addEventListener('click', () => {
            // Get values from inputs
            const S = parseFloat(document.getElementById('soNamE').value) || 0;
            const K = parseFloat(document.getElementById('khatKhao').value);
            const CT = parseFloat(document.getElementById('soLanChiaTay').value) || 0;
            const KD = parseFloat(document.getElementById('soLanKhongDo').value) || 0;
            const AT = parseFloat(document.getElementById('aoTuong').value);
            const H = parseFloat(document.getElementById('hanhDong').value);
            const TN = parseFloat(document.getElementById('tinhNgo').value);

            let chen = 0, kg = 0;
            let advice = '';
            const HAT_PER_CHEN = 250;
            const HAT_PER_KG = 3000;

            // Rule 0: The Ultimate Troll
            if (S >= 124) {
                chen = 3;
                kg = (chen * HAT_PER_CHEN) / HAT_PER_KG;
                advice = "Ở tầm này rồi thì chè đậu đỏ không còn tác dụng nữa. Hãy báo mộng cho con cháu cúng thêm con gà luộc ngậm hoa hồng, đĩa xôi gấc, bánh chưng, nem chua, tré, bánh ít lá gai, heo quay, bánh tét, canh khổ qua... may ra có người bầu bạn nơi chín suối.";
            }
            // Rule 1: User is in a relationship
            else if (S === 0) {
                chen = kg = Infinity;
                advice = "Ủa bạn ơi, đang có bồ mà còn vào đây tính toán là sao? Định tìm thêm à? Lượng chè cần ăn là vô cực để sám hối về sự thiếu chung thủy trong tư tưởng này nhé!";
            }
            // Rule 2: User has reached enlightenment
            else if (TN === 1.0) {
                chen = kg = 0;
                advice = "Chúc mừng thí chủ đã giác ngộ! Tình yêu giờ chỉ là mây bay gió thoảng. Bạn không cần chè đậu đỏ, hãy tận hưởng sự an yên tự tại và sống một cuộc đời không cần ai phải dỗ dành.";
            }
            // Rule 3: Main calculation for singles
            else {
                // New formula based on updated rules
                const chanhLech = Math.max(1, K - H); // Difference between desire and action

                let B = (S * K * chanhLech) * ((CT + 1) * Math.pow(AT, 1.5) * Math.pow(KD + 1, 2)) / TN;

                if (!isFinite(B)) {
                    B = Number.MAX_SAFE_INTEGER;
                }

                chen = B / HAT_PER_CHEN;
                // Rule: at least 1 cup of chè
                chen = Math.max(1, chen);

                kg = (chen * HAT_PER_CHEN) / HAT_PER_KG;
                const tan = kg / 1000;

                // --- WORLD DATA CONSTANTS (Approximate values for fun) ---
                const SAN_LUONG_THEGIOI_TAN = 1500000;
                const SAN_LUONG_CHAUA_TAN = 1000000;
                const SAN_LUONG_TRUNGQUOC_TAN = 400000;
                const SAN_LUONG_NHATBAN_TAN = 60000;
                const SAN_LUONG_VN_TAN = 20000;
                const SAN_LUONG_HANQUOC_TAN = 10000;
                const SAN_LUONG_TINH_TAN = 1000; // A province's production
                const XE_TAI_TAN = 10; // A truck's capacity

                // Generate advice based on tons with real-world comparison
                if (tan > SAN_LUONG_THEGIOI_TAN) {
                    advice = `Kỷ lục của mọi thời đại! Lượng nghiệp của bạn cần tới ${formatNumberToText(tan / SAN_LUONG_THEGIOI_TAN)} lần tổng sản lượng đậu đỏ TOÀN THẾ GIỚI mới gột rửa nổi. Có lẽ bạn nên xem xét việc chuyển sang một hành tinh khác để tìm duyên.`;
                } else if (tan > SAN_LUONG_CHAUA_TAN) {
                    advice = `Nghiệp của bạn đủ lớn để "thầu" hết toàn bộ sản lượng đậu đỏ của cả CHÂU Á. Lời khuyên: Hãy xem xét lại toàn bộ các chỉ số, đặc biệt là 'Hệ số Ảo Tưởng'.`;
                } else if (tan > SAN_LUONG_TRUNGQUOC_TAN) {
                    advice = `Con số này đã vượt qua tổng sản lượng đậu đỏ hàng năm của Trung Quốc - quốc gia sản xuất lớn nhất thế giới. Lời khuyên: Hãy tăng 'Hệ số Hành Động' và 'Hệ số Giác Ngộ' lên. Thay vì ngồi ăn chè, hãy ra ngoài và hành động!`;
                } else if (tan > SAN_LUONG_NHATBAN_TAN) {
                    advice = `Để "giải nghiệp", bạn cần tiêu thụ hết toàn bộ sản lượng đậu đỏ của Nhật Bản. Có lẽ bạn nên bắt đầu học cách làm bánh Mochi nhân đậu đỏ để tiêu thụ cho nhanh.`;
                } else if (tan > SAN_LUONG_VN_TAN) {
                    advice = `Chúc mừng, bạn sẽ phải ăn hết toàn bộ sản lượng đậu các loại của Việt Nam trong một năm. Đây là dấu hiệu cho thấy sự chênh lệch giữa 'Khát Khao - Hành Động' của bạn đang quá cao.`;
                } else if (tan > SAN_LUONG_HANQUOC_TAN) {
                    advice = `Bạn cần "xử lý" hết lượng đậu đỏ hàng năm của Hàn Quốc. Thử ăn chè Bingsu đậu đỏ mỗi ngày xem có cải thiện được tình hình không nhé!`;
                } else if (tan > SAN_LUONG_TINH_TAN) {
                    advice = `Nghiệp của bạn đủ lớn để "cân" hết sản lượng đậu đỏ của một tỉnh nông nghiệp lớn như Đắk Lắk. Có lẽ bạn nên xem xét việc đầu tư vào nông nghiệp để tự cung tự cấp.`;
                } else if (tan > 1) {
                    const soXeTai = Math.round(tan / XE_TAI_TAN);
                    if (soXeTai > 1) {
                        advice = `Bạn sẽ cần một đoàn xe khoảng ${soXeTai} chiếc xe tải 10 tấn để chở hết số "nghiệp" này. Hãy bắt đầu liên hệ với công ty vận tải ngay đi là vừa.`;
                    } else {
                        advice = `Con số này đã lên tới hàng tấn! Đủ để lấp đầy một chiếc xe tải hạng nặng. Hãy bắt đầu lên kế hoạch "giải nghiệp" từ bây giờ là vừa.`;
                    }
                } else if (kg > 100) {
                    advice = `Hơn một tạ đậu đỏ! Đủ để bạn mở một tiệm chè nho nhỏ và chia sẻ "nghiệp duyên" này với những người đồng cảnh ngộ. Biết đâu lại tìm được "nửa kia" ở đó.`;
                } else if (kg > 10) {
                    advice = `Một vài bao tải đậu đỏ đang chờ bạn. Con số này tuy nhỏ so với thế giới nhưng cũng đủ để bạn ăn trong cả tháng. Hãy kiên trì nhé!`;
                } else {
                    advice = "Chúc mừng! Nghiệp của bạn rất nhẹ. Chỉ cần vài chén chè là đủ để 'buff' may mắn. Có khi chưa kịp ăn xong chén đầu tiên thì 'crush' đã nhắn tin rủ đi chơi rồi đó!";
                }
            }

            // Display results with new formatting
            let chenText = formatNumberToText(chen);
            if (chenText !== 'Vô Cực') {
                chenText += ' chén';
            }
            document.getElementById('result-dinhluong').textContent = chenText;
            document.getElementById('result-khoiluong').textContent = formatMass(kg);
            document.getElementById('result-advice').textContent = advice;

            // Show the result section
            resultSection.style.display = 'block';
            resultSection.scrollIntoView({ behavior: 'smooth' });
        });
    </script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());

        gtag('config', 'G-2RLZQDNQ1Y');
    </script>
</body>

</html>